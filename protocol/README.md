
## ファイルについて
本資料に同包されているファイルは，次のとおりである．簡単な説明を右に記載してある．

- udp_time_client.cpp : UDP を使った通信プログラムの例のserver 側
- udp_time_server.cpp : UDP を使った通信プログラムの例のclient 側
- tcp_time_server.cpp : TCP を使った通信プログラムの例のserver側
- tcp_time_client.cpp : TCP を使った通信プログラムの例のclient 側
- command.client.cpp : 簡易掲示板の実装に使える，コマンド送受信の例
- command.server.cpp : 簡易掲示板の実装に使える，コマンド送受信の例，サーバ側のプログラム
- ex_gettimeofday.cpp  : 時間を計測するコードの例
- Makefile : コンパイルを一度に行うための，コンパイルコマンドが記載された，コマンド make 用のファイル

## 試験方法

端末で make を実行すると，Makefile が読み込まれて，Makefile 中に書かれたコマンドによりすべてのプログラムがコンパイルされる．make は2回目以降に実行されると，前回実行時から変更のあったソースファイルに対応するコンパイルコマンドのみ実行する．この仕組みにより，度々改変を行う作業においてコンパイル時間を短縮し作業の効率化を行うことができる．

プログラムの動作確認方法を以下に示す．make で予めコンパイルしておく．
まず，UDP のプログラムの試験を行う．以下のコマンドで，UDP のサーバを起動する．

./uts

このとき，上記を実行した端末は，サーバの実行のために他の操作を受け付けなくなる．サーバは，クライアントからの接続を待機するため，プログラム中で待機しているため，端末に制御が戻らず，このようになっている．このサーバのプログラムに通信の試験をクライアントのプログラムで行うために，別に端末を立ち上げる．端末を立ち上げたら，サーバが動いている端末を注視しつつ，以下のコマンドにより，クライアントを実行する．

./utc

上記が実行された瞬間，サーバの端末に変化があるはずである．TCP についても，サーバを ./tts, クライアントを ./ttc で実行して，同様に動作を確認することができる．

## 宛先のサーバの指定方法

通信相手は，クライアントが決定する．サーバは待つだけで，通信する相手を能動的に選ぶことはできない．よって，通信の対を変更するためには，クライアント側のプログラムで対応する必要がある．udp_time_client.cpp を見られよ．このファイルの中の，30行目付近の以下，

char* serv_ip = "127.0.0.1"; // ループバックアドレス

により，宛先のサーバのIPアドレスを指定するようになっている．この値を，通信したいサーバが実行されているホストのアドレスに書き換えれば，そのサーバと通信が可能となる．ip アドレスについては，サーバ側で，ip addr などのコマンドで調べると良い．

また，添付のプログラムは，コマンドライン引数からIPアドレスを読み込むようになっているから，この機能を使うことも出る．例えば，サーバのIPを 8.8.8.8 としたとき，

./utc 8.8.8.8

と実行すれば，8.8.8.8 のホストのサーバへ通信できるようになる．端末でコマンドを実行したとき，プログラム名の後ろに書かれた文字列は，半角スペースで区切られて，関数 main の argv　に配列として格納されるため，ここから IP アドレスの文字列を読み込むことでこれを可能としている．



